<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PathFinder AI - Career Architect</title>

    <!-- 1. CSS FRAMEWORK (Tailwind) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 2. ICONS (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- 3. CUSTOM CSS -->
    <style>
      /* Custom Animations & Base Styles */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8fafc; /* slate-50 */
        color: #0f172a; /* slate-900 */
      }

      .dark body {
        background-color: #020617; /* slate-950 */
        color: #f1f5f9; /* slate-100 */
      }

      /* Gauge Animation */
      .gauge-circle {
        transition: stroke-dashoffset 1.5s ease-out;
      }

      /* View Transitions */
      .view-section {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      }
      .view-section.active {
        display: block;
        opacity: 1;
        animation: fadeIn 0.5s forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900 min-h-screen pb-20">
    <!-- NAVIGATION -->
    <nav
      class="border-b border-slate-200 bg-white/80 backdrop-blur-md sticky top-0 z-50"
    >
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between"
      >
        <div
          class="flex items-center gap-2 cursor-pointer"
          onclick="app.setStep('upload')"
        >
          <div class="bg-indigo-600 p-2 rounded-lg shadow-lg">
            <i data-lucide="sparkles" class="text-white w-5 h-5"></i>
          </div>
          <span
            class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-violet-500"
          >
            PathFinder AI
          </span>
        </div>
        <button
          id="back-btn"
          onclick="app.setStep('dashboard')"
          class="hidden flex items-center gap-2 text-sm font-bold text-slate-500 hover:text-indigo-600 transition-colors"
        >
          <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Analysis
        </button>
      </div>
    </nav>

    <!-- MAIN CONTAINER -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <!-- VIEW: UPLOAD -->
      <div
        id="view-upload"
        class="view-section active max-w-3xl mx-auto text-center py-10"
      >
        <h1
          class="text-5xl sm:text-6xl font-black mb-6 tracking-tight leading-tight"
        >
          Optimize Your <span class="text-indigo-600">Career</span> with âœ¨
          Intelligence
        </h1>
        <p
          class="text-xl text-slate-600 mb-12 max-w-2xl mx-auto leading-relaxed"
        >
          Upload your resume for a multimodal ATS compatibility audit and
          high-intensity learning roadmap.
        </p>

        <div
          class="border-4 border-dashed border-slate-200 bg-white rounded-[3rem] p-20 transition-all hover:border-indigo-400 group relative shadow-2xl shadow-slate-200/50"
        >
          <input
            type="file"
            id="file-input"
            class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
            accept=".pdf,.doc,.docx,image/*"
          />
          <div class="flex flex-col items-center pointer-events-none">
            <div
              class="w-24 h-24 bg-indigo-50 rounded-[2rem] flex items-center justify-center mb-8"
            >
              <i data-lucide="upload" class="text-indigo-600 w-12 h-12"></i>
            </div>
            <p id="file-name" class="text-2xl font-black mb-2 text-slate-900">
              Drop Resume File
            </p>
            <p
              class="text-sm font-bold text-slate-400 uppercase tracking-widest"
            >
              Support for PDF, JPG, PNG, DOCX
            </p>
          </div>
        </div>

        <button
          id="analyze-btn"
          disabled
          onclick="app.runAnalysis()"
          class="mt-12 px-16 py-6 rounded-[2rem] font-black text-2xl bg-indigo-600 text-white hover:bg-indigo-700 transition-all flex items-center gap-4 mx-auto shadow-xl shadow-indigo-500/40 disabled:bg-slate-300 disabled:shadow-none disabled:cursor-not-allowed transform hover:-translate-y-1 active:scale-95"
        >
          <i data-lucide="sparkles" class="w-8 h-8"></i>
          <span>Generate AI Report</span>
        </button>

        <div
          id="error-message"
          class="hidden mt-6 text-rose-500 font-bold bg-rose-50 p-4 rounded-xl"
        ></div>
      </div>

      <!-- VIEW: ANALYZING -->
      <div
        id="view-analyzing"
        class="view-section flex flex-col items-center justify-center py-32"
      >
        <div class="relative w-40 h-40 mb-12">
          <div
            class="absolute inset-0 border-[12px] border-indigo-100 rounded-full animate-pulse"
          ></div>
          <div
            class="absolute inset-0 border-[12px] border-indigo-600 rounded-full border-t-transparent animate-spin"
          ></div>
          <div class="absolute inset-0 flex items-center justify-center">
            <i data-lucide="target" class="text-indigo-600 w-16 h-16"></i>
          </div>
        </div>
        <h2 class="text-4xl font-black mb-4 tracking-tight text-slate-900">
          AI Neural Scan in Progress...
        </h2>
        <p
          class="text-slate-400 font-bold uppercase tracking-widest text-sm animate-pulse"
        >
          Checking keyword saturation & formatting
        </p>
      </div>

      <!-- VIEW: DASHBOARD -->
      <div id="view-dashboard" class="view-section space-y-10">
        <!-- Dynamic Content Injected via JS -->
      </div>

      <!-- VIEW: PLANNER -->
      <div id="view-planner" class="view-section max-w-5xl mx-auto">
        <!-- Dynamic Planner Content Injected via JS -->
      </div>
    </main>

    <!-- 4. JAVASCRIPT LOGIC -->
    <script>
      const apiKey = "AIzaSyAKaiZG8bsj613nky0IfKF30pYePNlZWYQ";
      const MODEL_NAME = "gemini-2.5-flash-preview-09-2025";

      const app = {
        state: {
          step: "upload",
          file: null,
          fileBase64: null,
          analysis: null,
        },

        els: {
          views: {
            upload: document.getElementById("view-upload"),
            analyzing: document.getElementById("view-analyzing"),
            dashboard: document.getElementById("view-dashboard"),
            planner: document.getElementById("view-planner"),
          },
          fileInput: document.getElementById("file-input"),
          fileName: document.getElementById("file-name"),
          analyzeBtn: document.getElementById("analyze-btn"),
          backBtn: document.getElementById("back-btn"),
          errorMsg: document.getElementById("error-message"),
        },

        /* ================= INIT ================= */
        init() {
          this.els.fileInput.addEventListener("change", (e) =>
            this.handleFile(e)
          );
          lucide.createIcons();
        },

        /* ================= FIXED VIEW SWITCH ================= */
        setStep(step) {
          Object.entries(this.els.views).forEach(([key, el]) => {
            if (key === step) {
              el.style.display = "block";
              requestAnimationFrame(() => el.classList.add("active"));
            } else {
              el.classList.remove("active");
              setTimeout(() => (el.style.display = "none"), 400);
            }
          });
          window.scrollTo(0, 0);
        },

        /* ================= FILE ================= */
        handleFile(e) {
          const file = e.target.files[0];
          if (!file) return;
          this.state.file = file;
          this.els.fileName.innerText = file.name;
          this.els.analyzeBtn.disabled = false;

          const reader = new FileReader();
          reader.onload = () => {
            this.state.fileBase64 = reader.result.split(",")[1];
          };
          reader.readAsDataURL(file);
        },

        /* ================= API ================= */
        async callGemini(userPrompt, systemPrompt, isImage) {
          const payload = {
            contents: [
              {
                parts: [
                  { text: userPrompt },
                  ...(isImage
                    ? [
                        {
                          inlineData: {
                            mimeType: this.state.file.type,
                            data: this.state.fileBase64,
                          },
                        },
                      ]
                    : []),
                ],
              },
            ],
            systemInstruction: { parts: [{ text: systemPrompt }] },
            generationConfig: { responseMimeType: "application/json" },
          };

          const res = await fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload),
            }
          );

          const data = await res.json();
          return JSON.parse(data.candidates[0].content.parts[0].text);
        },

        /* ================= ANALYSIS ================= */
        async runAnalysis() {
          this.setStep("analyzing");

          const systemPrompt = `
Return JSON only:
{
 "score": number,
 "keywordScore": number,
 "structureScore": number,
 "formattingScore": number,
 "elevatorPitch": string,
 "skillsFound": string[],
 "missingKeywords": string[],
 "recommendedRoles": [{"title": string, "company": string, "match": number}],
 "learningRoadmap": [{"skill": string, "priority": "High" | "Medium"}]
}`;

          try {
            const isImage = this.state.file.type.startsWith("image/");
            this.state.analysis = await this.callGemini(
              "Analyze resume deeply for ATS, skills, roles and learning path",
              systemPrompt,
              isImage
            );
            this.renderDashboard();
            this.setStep("dashboard");
          } catch (e) {
            console.error(e);
            this.setStep("upload");
            this.els.errorMsg.innerText = "Resume analysis failed.";
            this.els.errorMsg.classList.remove("hidden");
          }
        },

        /* ================= DASHBOARD ================= */
        renderDashboard() {
          const d = this.state.analysis;
          const c = this.els.views.dashboard;

          c.innerHTML = `
<div class="space-y-10">

<!-- ATS SCORE -->
<div class="bg-white p-8 rounded-3xl shadow">
  <h2 class="text-4xl font-black mb-2">ATS Score: ${d.score}/100</h2>
  <p class="italic text-slate-600">"${d.elevatorPitch}"</p>
</div>

<!-- SUB SCORES -->
<div class="grid md:grid-cols-3 gap-6">
  <div class="p-6 bg-indigo-50 rounded-2xl font-bold">Keyword Match: ${
    d.keywordScore
  }%</div>
  <div class="p-6 bg-violet-50 rounded-2xl font-bold">Structure: ${
    d.structureScore
  }%</div>
  <div class="p-6 bg-emerald-50 rounded-2xl font-bold">Formatting: ${
    d.formattingScore
  }%</div>
</div>

<!-- SKILLS -->
<div class="bg-white p-8 rounded-3xl shadow">
  <h3 class="text-xl font-black mb-4">Skills Found</h3>
  <div class="flex flex-wrap gap-2 mb-6">
    ${d.skillsFound
      .map((s) => `<span class="px-3 py-1 bg-green-100 rounded-xl">${s}</span>`)
      .join("")}
  </div>

  <h3 class="text-xl font-black mb-4">Missing / Weak Skills</h3>
  <div class="flex flex-wrap gap-2">
    ${d.missingKeywords
      .map((s) => `<span class="px-3 py-1 bg-red-100 rounded-xl">${s}</span>`)
      .join("")}
  </div>
</div>

<!-- JOB ROLES -->
<div class="bg-white p-8 rounded-3xl shadow">
  <h3 class="text-xl font-black mb-6">Roles You Can Apply For</h3>
  <div class="space-y-4">
    ${d.recommendedRoles
      .map(
        (r) => `
      <div class="p-5 border rounded-2xl flex justify-between">
        <div>
          <p class="font-black">${r.title}</p>
          <p class="text-sm text-slate-500">${r.company}</p>
        </div>
        <div class="font-black text-indigo-600">${r.match}%</div>
      </div>
    `
      )
      .join("")}
  </div>
</div>

<!-- LEARNING ROADMAP -->
<div class="bg-slate-900 text-white p-10 rounded-3xl">
  <h3 class="text-2xl font-black mb-6">Recommended Skills to Learn</h3>
  <div class="grid md:grid-cols-3 gap-6">
    ${d.learningRoadmap
      .map(
        (l) => `
      <div class="p-6 bg-white/10 rounded-2xl">
        <p class="font-black">${l.skill}</p>
        <span class="text-xs uppercase ${
          l.priority === "High" ? "text-rose-400" : "text-amber-400"
        }">
          ${l.priority} Priority
        </span>
      </div>
    `
      )
      .join("")}
  </div>
</div>

</div>
`;
          lucide.createIcons();
        },
      };

      app.init();
    </script>
  </body>
</html>
